Nivel C:

- Q1 The average, the minimum, the maximum, and the standard deviation of the number of fix-up tasks per user.

Query: select avg(u.fixuptask.size), min(u.fixuptask.size) , max(u.fixuptask.size), sqrt(sum(u.fixuptask.size*u.fixuptask.size)/count(u.fixuptask.size)-(avg(u.fixuptask.size)*avg(u.fixuptask.size))) from User u;

Descripción: Al utilizar esta consulta, podemos obtener el promedio, el mínimo, el máximo y la desviación estándar del número de fix-up tasks por user.

- Q2 The average, the minimum, the maximum, and the standard deviation of the number of applications per fix-up task.

Query: select avg(f.applications.size), min(f.applications.size) , max(f.applications.size), sqrt(sum(f.applications.size*f.applications.size)/count(f.applications.size)-(avg(f.applications.size)*avg(f.applications.size))) from FixUpTask f;

Descripción: Al utilizar esta consulta, podemos obtener el promedio, el mínimo, el máximo y la desviación estándar del número de applications por fix-up tasks.

- Q3 The average, the minimum, the maximum, and the standard deviation of the maximum price of the fix-up tasks.

Query: select avg(f.maxPrice.size), min(f.maxPrice.size) , max(f.maxPrice.size), sqrt(sum(.size*f.maxPrice.size)/count(f.maxPrice.size)-(avg(f.maxPrice.size)*avg(f.maxPrice.size))) from FixUpTask f;
f.applications

- Q4 The average, the minimum, the maximum, and the standard deviation of the price offered in the applications.

Query: select avg(a.offeredPrice.size), min(a.offeredPrice.size) , max(a.offeredPrice.size), sqrt(sum(.size*a.offeredPrice.size)/count(a.offeredPrice.size)-(avg(a.offeredPrice.size)*avg(a.offeredPrice.size))) from Application a;

- Q5 The ratio of pending applications.

Query: select sum(case when a.status = 'PENDING' then 1.0 else 0.0 end)/count(a) from Application a;

- Q6 The ratio of accepted applications.

Query: select sum(case when a.status='ACCEPTED' then 1.0 else 0.0 end)/count(a) from Application a;

- Q7 The ratio of rejected applications.

Query: select sum(case when a.status='REJECTED' then 1.0 else 0.0 end)/count(a) from Application a;

- Q8 The ratio of pending applications that cannot change its status because their time period’s elapsed.

Query: select (select count(a) from application a join a.fixuptask f where f.periodstart <= current_date) / (select count(b) from application b))*100;

- Q9 The listing of customers who have published at least 10% more fix-up tasks than the average, ordered by number of applications.

Query: select c from customer c where (select count(f) from c.fixuptask f where f.id_fixuptask = c.id_fixuptask and f.status = 'published') >= select ((
select count(a) from customer cu join cu.application a where a.status = 'published') / (select count(cust) from customer cus))*1.1;

select c from Customer c join c.task t ordered by t.applications.size;

- Q10 The listing of handy workers who have got accepted at least 10% more ap-plications than the average, ordered by number of applications.

Query: select w from handyworker w where (select count(p) from w.application p where p.id_handyworker = w.id_handyworker and p.status = 'accepted') >= select ((
select count(a) from handyworker y join y.application a where a.status = 'accepted') / (select count(h) from handyworker h))*1.1;

select h from HandyWorker h join h.applications a join a.task t where a.status='ACCEPTED' order by t.complaints.size

----------------------------------------------

Nivel B:

- Q1 The minimum, the maximum, the average, and the standard deviation of the number of complaints per fix-up task.

Query: select min(f.complaint.size), max(f.complaint.size), avg(f.complaint.size), sqrt(sum(f.complaint.size*f.complaint.size)/count(f.complaint.size)-(avg(f.complaint.size)*avg(f.complaint.size))) from FixUpTask f;

Query: select avg((count (fx1 complaints), sqrt(sum(fx2 complaints *fx2 complaints)/ count (fx2(complaints)*(avg fx2.complaints)*avg(fx2 complaints))) from fixuptask fx1, 
fixuptask fx2);

- Q2 The minimum, the maximum, the average, and the standard deviation of the number of notes per referee report.

Query: select min(r.note.size), max(r.note.size), avg(r.note.size), sqrt(sum(r.note.size*r.note.size)/count(r.note.size)-(avg(r.note.size)*avg(r.note.size))) from Referee r;

- Q3 The ratio of fix-up tasks with a complaint.

Query: select sum(case when r.suspicious = 1 then 1.0 else 0.0 end)/count(r)  from FixUpTask f;

- Q4 The top-three customers in terms of complaints.

- Q5 The top-three handy workers in terms of complaints.

Query: select a handyworker from application a join a.fixuptask fx wher e(fx.complaints > 0) having (count (a handyworker) = 3)
order by fx complaints desc;

usar top y limit functions.

select top y order by desc limit 0.3.

select c from Customer c join c.tasks t order by t.complaints.size
